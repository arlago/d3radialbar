function RadialBar(t,e){this.elementId=t,this.svgCenter={x:e.width/2,y:e.height/2},this.config=e,this.degrees=new MathDegree(e.data.length)}function MathDegree(t){this.rotationDegree=this.getRotationDegree(t)}for(var config={data:[],width:320,height:320,center:{innerRadius:40,backgroundColor:"#000",text:[{text:"32",color:"#999",fontSize:24,font:"helvetica",topPadding:12},{text:"kWh",color:"#999",fontSize:16,font:"helvetica",topPadding:12}],textSpace:1,fontName:"Helvetica",fontSize:"15px",fontColor:"#000"},colors:{innerCircle:"#fff",outerCircle:"#e5e5e5"},outerRadius:110,labelDistance:15,labelType:"horizontal"},dataModelBase={label:{text:"",fontFamily:"Helvetica",fontSize:"9px",fontColor:"#000"},bar:{value:0,color:"#ff3b30",width:5}},currentDataModel,i=0;30>i;i++)currentDataModel=_.cloneDeep(dataModelBase),currentDataModel.label.text=i+1,currentDataModel.bar.value=70,config.data.push(currentDataModel);RadialBar.prototype.draw=function(){switch(this.createSvg(),this.createOuterCircle(),this.createBars(),this.config.labelType){case"circular":this.createCircularLabels();break;case"horizontal":this.createHorizontalLabels()}this.createInnerCircle(),this.createCentralText()},RadialBar.prototype.createSvg=function(){this.svg=d3.select("#"+this.elementId).append("svg").attr("id","radial0").attr("width",this.config.width).attr("height",this.config.height)},RadialBar.prototype.createOuterCircle=function(){var t=this;this.svg.append("circle").attr("cx",this.svgCenter.x).attr("cy",this.svgCenter.y).attr("r",this.config.outerRadius).attr("fill",function(e,r){return t.config.colors.outerCircle})},RadialBar.prototype.createBars=function(){var t=this;this.svg.selectAll("rect").data(this.config.data).enter().append("rect").attr("id",function(t,e){return"bar"+e}).attr("fill",function(t,e){return t.bar.color}).attr("width",function(t,e){return t.bar.value}).attr("height",function(t,e){return t.bar.width}).attr("x",function(e,r){return-1*(e.bar.value+t.config.center.innerRadius-10)}).attr("y",function(t,e){return-1*t.bar.width}).attr("rx",function(t,e){return 10>=t.bar.width?.4*t.bar.width:.3*t.bar.width}).attr("ry",function(t,e){return 10>=t.bar.width?.4*t.bar.width:.2*t.bar.width}).attr("transform",function(e,r){var n=t.degrees.getCurrentRotationDegree(r),a=e.bar.width/2*t.degrees.sin(n),i=e.bar.width/2*t.degrees.cos(n),o=t.svgCenter.x-a,s=t.svgCenter.y+i;return"translate("+o+","+s+") rotate("+n+")"})},RadialBar.prototype.createCircularLabels=function(){var t=this,e=this.svg.append("g").classed("labels",!0);e.append("def").append("path").attr("id","label-path").attr("d",function(e,r){var n=t.config.outerRadius+t.config.labelDistance,a=t.svgCenter.y-n,i=t.svgCenter.x;return"m"+i+" "+a+" a"+n+" "+n+" 0 1,1 -0.01 0"}),e.selectAll("text").data(this.config.data).enter().append("text").attr("degree",function(e,r){return t.degrees.getCurrentRotationDegree(r)}).attr("id",function(t,e){return"label"+e}).attr("font-family",function(t,e){return t.label.fontFamily}).attr("font-size",function(t,e){return t.label.fontSize}).attr("fill",function(t,e){return t.label.fontColor}).style("text-anchor","middle").append("textPath").attr("xlink:href","#label-path").attr("startOffset",function(e,r){return 100*r/t.config.data.length+"%"}).text(function(t,e){return t.label.text})},RadialBar.prototype.createHorizontalLabels=function(){function t(t){var e=0,a=r.degrees.getCurrentRotationDegree(t);switch(!0){case a>=0&&90>=a||a>360:e=r.svgCenter.x-n*r.degrees.cos(a);break;case a>90&&180>=a:e=r.svgCenter.x+n*r.degrees.cosAbs(a);break;case a>180&&270>=a:e=r.svgCenter.x+n*r.degrees.cosAbs(a);break;case a>270:e=r.svgCenter.x-n*r.degrees.cosAbs(a)}return e}function e(t){var e=0,a=r.degrees.getCurrentRotationDegree(t);switch(!0){case a>=0&&90>=a||a>360:e=r.svgCenter.y-n*r.degrees.sin(a);break;case a>90&&180>=a:e=r.svgCenter.y-n*r.degrees.sinAbs(a);break;case a>180&&270>=a:e=r.svgCenter.y+n*r.degrees.sinAbs(a);break;case a>270:e=r.svgCenter.y+n*r.degrees.sinAbs(a)}return e}var r=this,n=this.config.outerRadius+this.config.labelDistance;this.svg.selectAll("text").data(this.config.data).enter().append("text").attr("text-anchor","middle").attr("degree",function(t,e){return r.degrees.getCurrentRotationDegree(e)}).attr("id",function(t,e){return"label"+e}).attr("font-family",function(t,e){return t.label.fontFamily}).attr("font-size",function(t,e){return t.label.fontSize}).attr("fill",function(t,e){return t.label.fontColor}).text(function(t,e){return t.label.text}).attr("x",function(e,r){return t(r)}).attr("y",function(t,r){return e(r)+this.offsetHeight/4})},RadialBar.prototype.createInnerCircle=function(){var t=this;this.svg.append("circle").attr("cx",t.svgCenter.x).attr("cy",t.svgCenter.y).attr("r",t.config.center.innerRadius).attr("fill",function(e,r){return t.config.colors.innerCircle})},RadialBar.prototype.createCentralText=function(){var t=this;this.svg.append("text").attr("id","central-text").attr("text-anchor","middle").selectAll("tspan").data(this.config.center.text).enter().append("tspan").text(function(t,e){return t.text}).attr("dx",0).attr("fill",function(t){return t.color}).attr("font-size",function(t){return t.fontSize+"px"}).attr("font-family",function(t){return t.fontFamily}).attr("font-weight",function(t){return t.fontWeight}).attr("x",function(e,r){return t.svgCenter.x}).attr("dy",function(t,e){return this.offsetHeight}),this.svg.select("text#central-text").attr("y",function(e,r){var n=this.offsetHeight/2+config.center.textSpace;return t.svgCenter.y-n})},MathDegree.prototype.getRotationDegree=function(t){return 360/t},MathDegree.prototype.getCurrentRotationDegree=function(t){return this.rotationDegree*t+90},MathDegree.prototype.cos=function(t){return Math.cos(t*Math.PI/180)},MathDegree.prototype.sin=function(t){return Math.sin(t*Math.PI/180)},MathDegree.prototype.cosAbs=function(t){return Math.abs(this.cos(t))},MathDegree.prototype.sinAbs=function(t){return Math.abs(this.sin(t))};